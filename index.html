<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GitHub Code Viewer</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <style>
    :root {
      --sidebar-width: 280px;
      --sidebar-bg: #1e1e1e;
      --sidebar-color: #ddd;
      --code-bg: #0d1117;
      --code-color: #eee;
      --accent-color: #4ea1ff;
      --hover-color: #58a6ff;
      --transition-speed: 0.3s;
      --border-radius: 8px;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      height: 100vh;
      overflow: hidden;
      background: var(--code-bg);
      color: var(--code-color);
      display: flex;
      flex-direction: column;
    }
    
    /* Header */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 20px;
      background: rgba(0, 0, 0, 0.2);
      border-bottom: 1px solid #30363d;
      flex-shrink: 0;
    }
    
    .repo-info {
      display: flex;
      flex-direction: column;
    }
    
    .repo-name {
      font-weight: 600;
      font-size: 16px;
      color: var(--accent-color);
    }
    
    .repo-desc {
      font-size: 13px;
      color: #8b949e;
    }
    
    .toggle-sidebar {
      display: none;
      background: none;
      border: none;
      color: var(--accent-color);
      cursor: pointer;
      font-size: 20px;
    }
    
    /* Main container */
    .container {
      display: flex;
      flex: 1;
      overflow: hidden;
      height: calc(100vh - 60px);
    }
    
    /* Sidebar */
    #sidebar {
      width: var(--sidebar-width);
      background: var(--sidebar-bg);
      color: var(--sidebar-color);
      overflow-y: auto;
      padding: 15px;
      transition: transform var(--transition-speed) ease;
      border-right: 1px solid #30363d;
      z-index: 10;
      flex-shrink: 0;
    }
    
    #sidebar h3 {
      margin-top: 0;
      margin-bottom: 15px;
      color: #fff;
      padding-bottom: 10px;
      border-bottom: 1px solid #30363d;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    /* File tree */
    #fileTree ul {
      list-style-type: none;
      padding-left: 0;
    }
    
    #fileTree ul ul {
      padding-left: 20px;
    }
    
    #fileTree li {
      cursor: pointer;
      margin: 5px 0;
      padding: 6px 10px;
      border-radius: var(--border-radius);
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }
    
    #fileTree li:before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 3px;
      background: var(--accent-color);
      opacity: 0;
      transition: opacity 0.2s ease;
    }
    
    #fileTree li:hover {
      background: rgba(255, 255, 255, 0.05);
    }
    
    #fileTree li:hover:before {
      opacity: 1;
    }
    
    #fileTree li.file {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    #fileTree li.file:hover {
      color: var(--hover-color);
    }
    
    #fileTree li.folder {
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .folder-icon {
      transition: transform 0.3s ease;
    }
    
    li.folder.open > .folder-icon {
      transform: rotate(90deg);
    }
    
    /* Code container - FIXED SCROLLING ISSUE */
    .code-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      height: 100%;
    }
    
    .file-path {
      padding: 10px 20px;
      background: rgba(255, 255, 255, 0.03);
      border-bottom: 1px solid #30363d;
      font-size: 14px;
      color: #8b949e;
      display: flex;
      align-items: center;
      gap: 8px;
      flex-shrink: 0;
    }
    
    #codeBox {
      flex: 1;
      padding: 20px;
      background: var(--code-bg);
      color: var(--code-color);
      overflow: auto;
      transition: margin-left var(--transition-speed) ease;
      height: 100%;
    }
    
    pre {
      margin: 0;
      padding: 0;
      background: transparent !important;
      overflow: visible;
      height: 100%;
    }
    
    pre code {
      display: block;
      overflow-x: auto;
      padding: 0 !important;
    }
    
    /* Loading animation */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: var(--accent-color);
      animation: spin 1s ease-in-out infinite;
      margin-right: 10px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Empty state */
    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      color: #8b949e;
      text-align: center;
      padding: 20px;
    }
    
    .empty-state i {
      font-size: 48px;
      margin-bottom: 15px;
    }
    
    /* Responsive styles */
    @media (max-width: 768px) {
      :root {
        --sidebar-width: 240px;
      }
      
      .toggle-sidebar {
        display: block;
      }
      
      #sidebar {
        position: absolute;
        height: 100%;
        transform: translateX(-100%);
      }
      
      #sidebar.active {
        transform: translateX(0);
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
      }
      
      #codeBox {
        margin-left: 0 !important;
      }
      
      .overlay {
        position: fixed;
        top: 60px;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 5;
        opacity: 0;
        visibility: hidden;
        transition: all var(--transition-speed) ease;
      }
      
      .overlay.active {
        opacity: 1;
        visibility: visible;
      }
    }
    
    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
    }
    
    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 5px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }
    
    /* Code line numbers */
    .hljs {
      padding: 1em !important;
      border-radius: var(--border-radius);
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="repo-info">
      <span class="repo-name" id="repoName">üì¶ akared45/MVC</span>
      <span class="repo-desc" id="repoDesc">GitHub repository browser</span>
    </div>
    <button class="toggle-sidebar" id="toggleSidebar">‚ò∞</button>
  </div>
  
  <div class="container">
    <div id="sidebar">
      <h3>üìÇ Repository</h3>
      <div id="fileTree"></div>
    </div>
    
    <div class="overlay" id="overlay"></div>
    
    <div class="code-container">
      <div class="file-path" id="filePath">
        <span>üìÅ</span>
        <span>No file selected</span>
      </div>
      <pre><code id="codeBox"><div class="empty-state">
        <i>üìÅ</i>
        <p>Select a file from the sidebar to view its content</p>
      </div></code></pre>
    </div>
  </div>

<script>
const username = "akared45";   
const repo = "MVC";            
const branch = "main";         

// DOM elements
const repoNameEl = document.getElementById('repoName');
const repoDescEl = document.getElementById('repoDesc');
const toggleSidebarBtn = document.getElementById('toggleSidebar');
const overlay = document.getElementById('overlay');
const sidebar = document.getElementById('sidebar');
const filePathEl = document.getElementById('filePath');

// Update repo info
repoNameEl.textContent = `üì¶ ${username}/${repo}`;

// Toggle sidebar on mobile
toggleSidebarBtn.addEventListener('click', () => {
  sidebar.classList.toggle('active');
  overlay.classList.toggle('active');
});

overlay.addEventListener('click', () => {
  sidebar.classList.remove('active');
  overlay.classList.remove('active');
});

// Load repository description
async function loadRepoInfo() {
  try {
    const url = `https://api.github.com/repos/${username}/${repo}`;
    const res = await fetch(url);
    const data = await res.json();
    
    if (data.description) {
      repoDescEl.textContent = data.description;
    }
  } catch (error) {
    console.error('Failed to load repository info:', error);
  }
}

async function loadFolder(path, parentElement, isRoot = false) {
  // Show loading indicator
  if (isRoot) {
    parentElement.innerHTML = '<li><span class="loading"></span>Loading...</li>';
  }
  
  try {
    const url = `https://api.github.com/repos/${username}/${repo}/contents/${path}?ref=${branch}`;
    const res = await fetch(url);
    
    if (!res.ok) {
      throw new Error(`HTTP error! status: ${res.status}`);
    }
    
    const items = await res.json();
    
    // Clear loading indicator
    if (isRoot) {
      parentElement.innerHTML = '';
    } else {
      // Remove existing children if any
      while (parentElement.children.length > 1) {
        parentElement.removeChild(parentElement.lastChild);
      }
    }
    
    const ul = document.createElement('ul');
    
    // Sort folders first, then files
    items.sort((a, b) => {
      if (a.type === b.type) {
        return a.name.localeCompare(b.name);
      }
      return a.type === 'dir' ? -1 : 1;
    });
    
    items.forEach(item => {
      const li = document.createElement('li');
      
      if (item.type === 'dir') {
        li.innerHTML = `<span class="folder-icon">üìÅ</span> ${item.name}`;
        li.classList.add('folder');
        
        // Create nested UL for subitems
        const nestedUl = document.createElement('ul');
        nestedUl.style.display = 'none';
        
        li.appendChild(nestedUl);
        li.addEventListener('click', (e) => {
          e.stopPropagation();
          li.classList.toggle('open');
          
          if (li.classList.contains('open')) {
            nestedUl.style.display = 'block';
            if (nestedUl.children.length === 0) {
              loadFolder(item.path, li);
            }
          } else {
            nestedUl.style.display = 'none';
          }
        });
      } else if (item.type === 'file') {
        // Only show supported file types
        if (isSupportedFile(item.name)) {
          li.innerHTML = `<span>üìÑ</span> ${item.name}`;
          li.classList.add('file');
          li.addEventListener('click', () => loadFile(item.path, item.name));
        } else {
          return; // Skip unsupported files
        }
      }
      
      ul.appendChild(li);
    });
    
    if (isRoot) {
      parentElement.appendChild(ul);
    } else {
      parentElement.querySelector('ul').style.display = 'block';
      parentElement.appendChild(ul);
    }
  } catch (error) {
    console.error('Failed to load folder:', error);
    if (isRoot) {
      parentElement.innerHTML = `<li style="color: #f85149;">Error loading repository: ${error.message}</li>`;
    }
  }
}

function isSupportedFile(filename) {
  const supportedExtensions = ['.js', '.py', '.html', '.css', '.java', '.c', '.cpp', '.php', '.rb', '.go', '.rs', '.ts', '.json', '.xml', '.md', '.txt'];
  return supportedExtensions.some(ext => filename.endsWith(ext));
}

async function loadFile(path, filename) {
  // Show loading in code box
  const box = document.getElementById('codeBox');
  box.innerHTML = '<div class="empty-state"><span class="loading"></span>Loading file...</div>';
  box.className = '';
  
  // Update file path
  filePathEl.innerHTML = `<span>üìÑ</span> ${path}`;
  
  // Close sidebar on mobile after selection
  if (window.innerWidth <= 768) {
    sidebar.classList.remove('active');
    overlay.classList.remove('active');
  }
  
  try {
    const rawUrl = `https://raw.githubusercontent.com/${username}/${repo}/${branch}/${path}`;
    const res = await fetch(rawUrl);
    
    if (!res.ok) {
      throw new Error(`HTTP error! status: ${res.status}`);
    }
    
    const code = await res.text();
    
    // Set language class for syntax highlighting
    if (path.endsWith('.py')) box.className = 'language-python';
    else if (path.endsWith('.js')) box.className = 'language-javascript';
    else if (path.endsWith('.html')) box.className = 'language-html';
    else if (path.endsWith('.css')) box.className = 'language-css';
    else if (path.endsWith('.java')) box.className = 'language-java';
    else if (path.endsWith('.c') || path.endsWith('.cpp')) box.className = 'language-cpp';
    else if (path.endsWith('.php')) box.className = 'language-php';
    else if (path.endsWith('.rb')) box.className = 'language-ruby';
    else if (path.endsWith('.go')) box.className = 'language-go';
    else if (path.endsWith('.rs')) box.className = 'language-rust';
    else if (path.endsWith('.ts')) box.className = 'language-typescript';
    else if (path.endsWith('.json')) box.className = 'language-json';
    else if (path.endsWith('.xml')) box.className = 'language-xml';
    else if (path.endsWith('.md')) box.className = 'language-markdown';
    else box.className = '';
    
    // Clear any existing content and add the code
    box.innerHTML = '';
    const codeText = document.createTextNode(code);
    box.appendChild(codeText);
    
    // Apply syntax highlighting
    hljs.highlightElement(box);
  } catch (error) {
    console.error('Failed to load file:', error);
    box.innerHTML = `<div class="empty-state" style="color: #f85149;">
      <i>‚ùå</i>
      <p>Error loading file: ${error.message}</p>
    </div>`;
  }
}

// Initialize
loadRepoInfo();
loadFolder('', document.getElementById('fileTree'), true);
</script>
</body>
</html>